<div class="loading-demo-container">
  <header class="demo-header">
    <a 
      routerLink="/" 
      class="back-button"
      title="Volver a la pÃ¡gina de inicio"
      aria-label="Volver al inicio">â† Volver</a>
    <h1>â³ GestiÃ³n de Loading States</h1>
    <p class="subtitle">BehaviorSubject + Signals Locales + Contador de Peticiones</p>
  </header>

  <section class="demo-section">
    <h2>Loading Global (Overlay)</h2>
    <p>Spinner de pantalla completa para operaciones globales</p>
    <div class="button-grid">
      <button class="btn-primary" (click)="simulateGlobalLoading()">
        <span class="btn-icon">ğŸŒ</span>
        Simular Loading Global
      </button>
      <button class="btn-primary" (click)="simulateMultipleOperations()">
        <span class="btn-icon">ğŸ”„</span>
        Operaciones Concurrentes
      </button>
      <button class="btn-danger" (click)="resetLoading()">
        <span class="btn-icon">ğŸ”„</span>
        Reset Estado
      </button>
    </div>
  </section>

  <section class="demo-section">
    <h2>Loading Local (Botones)</h2>
    <p>Estados de carga especÃ­ficos por operaciÃ³n con signals</p>
    <div class="button-grid">
      <button 
        class="btn-success" 
        (click)="simulateLocalLoading()" 
        [disabled]="isSaving()">
        <span class="btn-icon">{{ isSaving() ? 'â³' : 'ğŸ’¾' }}</span>
        {{ isSaving() ? 'Guardando...' : 'Guardar' }}
      </button>
      
      <button 
        class="btn-danger" 
        (click)="simulateError()" 
        [disabled]="isDeleting()">
        <span class="btn-icon">{{ isDeleting() ? 'â³' : 'ğŸ—‘' }}</span>
        {{ isDeleting() ? 'Eliminando...' : 'Eliminar' }}
      </button>
      
      <button 
        class="btn-info" 
        (click)="simulateUpload()" 
        [disabled]="isUploading()">
        <span class="btn-icon">{{ isUploading() ? 'â³' : 'ğŸ“¤' }}</span>
        {{ isUploading() ? 'Subiendo...' : 'Upload' }}
      </button>
    </div>
  </section>

  <section class="theory-section">
    <h2>ğŸ“š CaracterÃ­sticas</h2>
    <div class="features-grid">
      <div class="feature-card">
        <h3>ğŸ”¢ Contador de Peticiones</h3>
        <p>Tracking de operaciones concurrentes con requestCount</p>
      </div>
      <div class="feature-card">
        <h3>ğŸŒ Loading Global</h3>
        <p>Overlay de pantalla completa con spinner animado</p>
      </div>
      <div class="feature-card">
        <h3>ğŸ“ Loading Local</h3>
        <p>Signals para estados especÃ­ficos en botones</p>
      </div>
      <div class="feature-card">
        <h3>ğŸ§¹ Cleanup Garantizado</h3>
        <p>finalize() de RxJS para limpiar estado siempre</p>
      </div>
      <div class="feature-card">
        <h3>ğŸ”„ Operaciones Concurrentes</h3>
        <p>Manejo correcto de mÃºltiples operaciones simultÃ¡neas</p>
      </div>
      <div class="feature-card">
        <h3>ğŸ”§ Reset Manual</h3>
        <p>MÃ©todo reset() para recuperaciÃ³n de errores</p>
      </div>
    </div>
  </section>

  <section class="code-section">
    <h2>ğŸ’» ImplementaciÃ³n</h2>
    <div class="code-examples">
      <div class="code-example">
        <h3>LoadingService</h3>
        <pre><code>private loadingService = inject(LoadingService);

// Mostrar loading
this.loadingService.show();

// Ocultar loading
this.loadingService.hide();

// Reset completo
this.loadingService.reset();</code></pre>
      </div>
      
      <div class="code-example">
        <h3>Loading Local con Signals</h3>
        <pre><code>isSaving = signal(false);

async save() &#123;
  this.isSaving.set(true);
  
  try &#123;
    await this.service.save();
  &#125; finally &#123;
    this.isSaving.set(false);
  &#125;
&#125;</code></pre>
      </div>

      <div class="code-example">
        <h3>Con RxJS y finalize()</h3>
        <pre><code>this.userService.save(user).pipe(
  finalize(() => this.loadingService.hide())
).subscribe(&#123;
  next: () => this.toast.success('Guardado'),
  error: () => this.toast.error('Error')
&#125;);</code></pre>
      </div>
    </div>
  </section>

  <section class="info-section">
    <h2>ğŸ’¡ Patrones de Uso</h2>
    <div class="pattern-grid">
      <div class="pattern-card">
        <h3>âœ… Loading Global</h3>
        <ul>
          <li>Carga inicial de aplicaciÃ³n</li>
          <li>Operaciones que afectan toda la UI</li>
          <li>MÃºltiples llamadas HTTP simultÃ¡neas</li>
        </ul>
      </div>
      <div class="pattern-card">
        <h3>âœ… Loading Local</h3>
        <ul>
          <li>Botones de formulario (Guardar, Eliminar)</li>
          <li>Operaciones especÃ­ficas de componente</li>
          <li>Feedback visual inmediato</li>
        </ul>
      </div>
      <div class="pattern-card">
        <h3>âœ… Combinado</h3>
        <ul>
          <li>Loading global + toast de confirmaciÃ³n</li>
          <li>Loading local + loading global para HTTP</li>
          <li>Signals + BehaviorSubject para flexibilidad</li>
        </ul>
      </div>
    </div>
  </section>
</div>
